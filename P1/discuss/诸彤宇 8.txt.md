---
teacher: 诸彤宇
group: 8
member:
   - 20231164 张岳霖
   - 20375007 汪文涵
   - 20373703 黄天俊
   - 20231006 古翔远
   - 20373121 马赛龙
---

#  第一单元里如何进行表达式的化简？好的架构能够带来什么优势？

经过讨论，我们从 第一单元里如何进行表达式的化简？好的架构能够带来什么优势？这一问题出发，细化到以下几个主题：

- 表达式的存储方法和化简技巧
- 探讨最佳的架构方法，分析其优势

------

## 第一个主题：表达式的存储方法和化简技巧

该主题主要聚焦于归纳和总结表达式，尤其是对表达式中的三角函数的化简技巧。

黄天俊同学首先提出采用`Expr = Hashmap<Vars*Triangles,coef>`的方法存储表达式。将变量因子和三角函数的乘积作为Hashmap的key，常数因子乘积的结果作为Hashmap的value。这种存储表达式的方法有利于表达式的合并。合并表达式时仅需要将相等的key的value加和即可。这种存储表达式的方法得到了大部分小组成员的认同。

针对表达式的化简技巧，我们小组针对三角函数本身的化简和三角函数之间的合并，展开了丰富的讨论。

马赛龙同学首先提出了可以将`sin(0) = 0 cos(0) = 1`进行表达式的化简。这种化简方式是我们最容易实现的，也是对程序性能提升最大的。小组内所有成员都进行了这一步优化。

古翔远同学提出了我们可以利用三角函数奇偶性进行化简。当处理的三角函数中的表达式具有前导负号时，可以利用该性质反转表达式因子之间的正负号，能达到去除表达式前导负号的效果。

我们小组又进一步深入探讨了采用二倍角公式、两角和公式进行化简的可行性和实现复杂程度

汪文涵同学提出，采用二倍角公式化简的可行性要高于采用两角和公式化简。采用二倍角公式化简需要遍历项内部的因子，而采用两角和公式化简则需要先遍历表达式内部的项，再遍历项内部的因子寻找出满足两角和公式的因子。单单从遍历寻找能够满足合并公式的表达式目标来看，采用二倍角公式合并就更加容易实现。

由于三角函数中的因子可能是需要加括号的表达式因子，也可能是不需要加括号的其它因子，我们小组探讨了如何在输出时仅添加必要的括号。汪文涵同学提出，可以在输出三角函数前，重新对三角函数因子中的表达式因子进行建模，得到表达式因子包含的因子数量。当因子数量为1时，不对表达式加括号；因子数量大于等于2时则需要加括号。尽管会消耗一定的算力，这种方法优势在于巧妙地的复用了原始代码，便于实现。

马赛龙同学补充指出，我们在优化代码时，要尽量避免采用`replaceAll()`方法对输出字符串进行粗暴的替换，这种方法往往可能会造成一些不可预料的错误，比如：

```java
"x*11".replaceAll("\\*1","")  -> "x1"
```

这一观点得到了大家的一致认同。

## 第二个主题：探讨最佳的架构方法，分析其优势

该主题主要聚焦于分享和探讨出合理的架构方法，分析架构方法的优缺点

汪文涵同学分享了他的架构方法，即将因子、项和表达式统一看作是表达式。忽略三者的细节差异，采用统一的规则记录因子、项和表达式。这样在表达式合并时，就可以按照一定的规则统一进行合并，无需采用`instance of`方法分类讨论。这种方法的不足之处是无法判断三角函数中的因子是表达式因子还是其它因子，这为判断是否需要在输出时添加括号带来了麻烦，汪文涵同学采用了上文中的重新建模三角函数中的表达式的方法处理这个问题，造成了一定的算力浪费。我们小组一致认为汪文涵同学的架构是极佳的架构方法。

